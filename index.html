<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alex MacMillan | Employment Law Barrister</title>
    <meta name="description" content="The professional website for Alex MacMillan, a UK-based employment law barrister, featuring articles and legal calculators.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        /* --- Styles --- */
        :root {
            --bg-color: #ffffff;
            --sidebar-bg: #f5f5f5;
            --text-color: #333333;
            --heading-color: #111111;
            --accent-color: #003366; /* A professional navy blue */
            --border-color: #e0e0e0;
            --link-hover-bg: #e9e9e9;
            --red-flag-bg: #fff5f5;
            --red-flag-border: #e5383b;
            --green-flag-bg: #f6fff8;
            --green-flag-border: #40916c;
        }
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        .site-wrapper { display: flex; min-height: 100vh; }
        .sidebar { width: 280px; background-color: var(--sidebar-bg); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; position: fixed; height: 100%; overflow-y: auto; }
        .sidebar-content { padding: 1.5rem; }
        .main-content { margin-left: 280px; padding: 2rem 3rem; width: calc(100% - 280px); }
        header { text-align: center; margin-bottom: 2rem; }
        .profile-photo { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 3px solid var(--border-color); margin-bottom: 1rem; }
        h1, h2, h3, h4, h5 { font-family: 'DM Serif Display', serif; color: var(--heading-color); margin-top: 0; }
        h1 { font-size: 1.8rem; margin-bottom: 0.25rem; }
        .subtitle { font-size: 1rem; color: var(--accent-color); margin-top: 0; font-weight: 600; }
        .call-date { font-size: 0.9rem; color: #666; margin-top: 0.5rem; }
        .sidebar-nav { margin-bottom: 1.5rem; }
        .sidebar-nav h4 { margin-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }
        .sidebar-nav a, .articles-nav a { display: block; padding: 0.6rem 1rem; text-decoration: none; color: var(--text-color); border-radius: 4px; margin-bottom: 0.25rem; transition: background-color 0.2s; }
        .sidebar-nav a:hover, .articles-nav a:hover { background-color: var(--link-hover-bg); }
        .sidebar-nav a.nav-active, .articles-nav a.nav-active { background-color: var(--accent-color); color: white; font-weight: 600; }
        .articles-nav ul { list-style-type: none; padding: 0; margin: 0; }
        .contact-box { background-color: #e9e9e9; padding: 1rem; border-radius: 4px; font-size: 0.9rem; }
        .contact-box h3 { margin-top: 0; }
        .contact-box a { color: var(--accent-color); }
        footer { font-size: 0.8rem; color: #777; text-align: center; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color); }
        section { margin-bottom: 2.5rem; }
        .content-list { list-style: none; padding-left: 0; }
        .content-list li { padding-left: 1.5rem; text-indent: -1.5rem; margin-bottom: 1rem; }
        .content-list li::before { content: '■'; color: var(--accent-color); padding-right: 0.75rem; }
        .testimonial-item { border-left: 3px solid var(--accent-color); padding-left: 1.5rem; margin-bottom: 1.5rem; }
        .testimonial-item p { margin-top: 0; font-style: italic; }
        .testimonial-item cite { font-style: normal; font-weight: 600; color: #555; }
        .article-item h3 { margin-bottom: 0.5rem; }
        .article-item hr { margin: 2rem 0; }
        .calculator-section { max-width: 900px; }
        .calculator-disclaimer { background-color: #fffbe6; border: 1px solid #ffe58f; padding: 1rem; border-radius: 4px; margin-bottom: 2rem; }
        .calculator-disclaimer p { margin: 0; }
        .calculator-grid, .respondent-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; align-items: end; margin-bottom: 1rem; }
        .calculator-inputs label, .calculator-inputs h3 { display: block; font-weight: 600; margin-bottom: 0.5rem; }
        .calculator-inputs h3 { margin-top: 2rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }
        .calculator-inputs input[type="date"], .calculator-inputs input[type="text"], .calculator-inputs input[type="number"], .calculator-inputs select { width: 100%; padding: 0.6rem; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-family: 'Inter', sans-serif; font-size: 1rem; }
        .respondent-row .remove-btn-wrapper { padding-bottom: 0.6rem; }
        .calc-button, #add-respondent-btn, #calculate-btn, .remove-btn { font-family: 'Inter', sans-serif; font-weight: 600; padding: 0.75rem 1.5rem; border-radius: 4px; border: none; cursor: pointer; transition: background-color 0.2s; }
        #add-respondent-btn { background-color: #e0e0e0; color: #333; }
        .calc-button, #calculate-btn { background-color: var(--accent-color); color: white; display: block; width: 100%; margin-top: 2rem; font-size: 1.1rem; }
        .remove-btn { background-color: #f44336; color: white; padding: 0.6rem; width: 100%; }
        #add-respondent-btn:hover { background-color: #d0d0d0; }
        .calc-button:hover, #calculate-btn:hover { background-color: #002244; }
        .remove-btn:hover { background-color: #d32f2f; }
        #limitation-calculator-results, .pay-calculator-results { margin-top: 2rem; }
        .error-message { color: #d32f2f; font-weight: bold; margin-bottom: 1rem; }
        .result-summary { font-size: 1.2rem; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; }
        .result-summary-earliest { background-color: #e6f4ea; border: 1px solid #b2d8b5; color: #2d6a4f; }
        .result-summary-passed { background-color: #ffebee; border: 1px solid #ffcdd2; color: #c62828; }
        .pay-result-box { background-color: #e6f4ea; border: 1px solid #b2d8b5; padding: 1.5rem; border-radius: 4px; }
        .pay-result-box .result-headline { font-family: 'DM Serif Display', serif; font-size: 2.5rem; color: #2d6a4f; margin: 0 0 1rem 0; text-align: center; }
        .pay-result-box .result-breakdown { font-size: 0.9rem; line-height: 1.5; color: #333; }
        .pay-result-box .result-breakdown strong { color: #111; }
        .pay-result-box hr { border: 0; border-top: 1px solid #b2d8b5; margin: 1rem 0; }
        .results-table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; font-size: 0.9rem; }
        .results-table th, .results-table td { border: 1px solid var(--border-color); padding: 0.8rem; text-align: left; }
        .results-table th { background-color: var(--sidebar-bg); }
        .results-table .highlight-row { background-color: #e6f4ea; }
        
        /* Checklist Styles */
        .checklist-section { padding-bottom: 1.5rem; margin-bottom: 1.5rem; border-bottom: 1px solid var(--border-color); }
        .checklist-question { margin-bottom: 1rem; }
        .checklist-question p { margin: 0 0 0.5rem 0; font-weight: 600; }
        .checklist-question label { margin-right: 1.5rem; font-weight: normal; cursor: pointer; }
        .checklist-report { margin-top: 2rem; }
        .report-section { margin-bottom: 2rem; }
        .report-section h4 { border-bottom: 2px solid; padding-bottom: 0.5rem; }
        .report-green h4 { border-color: var(--green-flag-border); }
        .report-red h4 { border-color: var(--red-flag-border); }
        .green-flag, .red-flag { padding: 1rem; border-left-width: 5px; border-left-style: solid; margin-bottom: 1rem; border-radius: 0 4px 4px 0; }
        .green-flag { background-color: var(--green-flag-bg); border-color: var(--green-flag-border); }
        .red-flag { background-color: var(--red-flag-bg); border-color: var(--red-flag-border); }
        .red-flag-title { font-weight: bold; color: var(--red-flag-border); }
        .red-flag blockquote { font-style: italic; margin: 0.5rem 0; padding: 0.5rem 1rem; background: #f8f8f8; border-left: 3px solid #ccc; }
        .red-flag-implication { font-size: 0.9rem; }
    </style>

</head>
<body>

    <div class="site-wrapper">
        <aside class="sidebar">
             <div class="sidebar-content">
                <header>
                    <img src="professional_headshot.jpg" alt="Professional headshot of Alexander MacMillan, Barrister" class="profile-photo" onerror="this.onerror=null;this.src='https://placehold.co/150x150/EFEFEF/333333?text=A.M.';">
                    <h1>Alex MacMillan</h1>
                    <p class="subtitle">Employment Law Barrister</p>
                    <p class="call-date">Called to the Bar: 2015</p>
                </header>

                <nav class="sidebar-nav">
                    <h4>Main</h4>
                    <a href="javascript:void(0);" onclick="showPage('profile-view');" class="nav-active">Main Profile</a>
                    <a href="https://www.st-philips.com/our_people/alexander-macmillan/" target="_blank" rel="noopener noreferrer">Official Chambers Profile</a>
                    <a href="https://www.linkedin.com/in/dralexandermacmillan/" target="_blank" rel="noopener noreferrer">LinkedIn Profile</a>
                </nav>

                <nav class="sidebar-nav">
                    <h4>Calculators & Tools</h4>
                    <a href="javascript:void(0);" onclick="showPage('limitation-view');">Limitation Date Calculator</a>
                    <a href="javascript:void(0);" onclick="showPage('holiday-pay-view');">Holiday Pay Calculator</a>
                    <a href="javascript:void(0);" onclick="showPage('redundancy-pay-view');">Redundancy Pay Calculator</a>
                    <a href="javascript:void(0);" onclick="showPage('disciplinary-view');">Disciplinary Process Checklist</a>
                </nav>

                <nav class="sidebar-nav articles-nav">
                    <h4>Articles</h4>
                    <ul>
                        <li><a href="javascript:void(0);" onclick="showPage('article-tupe-defence');">No "personal reasons" defence...</a></li>
                        <li><a href="javascript:void(0);" onclick="showPage('article-prosecutors-fallacy');">The Prosecutor’s Fallacy</a></li>
                        <li><a href="javascript:void(0);" onclick="showPage('article-prospects-percentages');">On Percentage Prospects</a></li>
                        <li><a href="javascript:void(0);" onclick="showPage('article-forced-distribution');">On Forced Distributions</a></li>
                        <li><a href="javascript:void(0);" onclick="showPage('article-employment-casino');">The Employment Law Casino</a></li>
                    </ul>
                </nav>

                <div class="contact-box">
                    <h3>Contact</h3>
                    <p class="chambers-details">
                        <strong>St Philips Barristers</strong><br>
                        Email: <a href="mailto:employment&pi@st-philips.com">employment&pi@st-philips.com</a><br>
                        Telephone: +44 (0) 121 246 7015
                    </p>
                </div>
                
                <footer>
                    <p>&copy; 2025 Alex MacMillan</p>
                </footer>
            </div>
        </aside>

        <main class="main-content">
            <div id="profile-view" class="page-view">
                <section id="about">
                    <h2>Profile</h2>
                    <p>An employment specialist with complementary expertise at the complex interface of employment and commercial contractual dispute resolution, Alexander MacMillan is one of the most active employment barristers on the circuit. Clients come to Alex, in part, because of his all-round capability in the employment arena, as well as the measured, thorough and reassuring way in which he works. Alex also maintains a particularly lively advisory practice and is, quite increasingly, sought out on some of the most esoteric and complicated points of employment law.</p>
                    <p>Comfortable in the appellate courts, and with several recent appearances before the EAT, High Court, and Court of Appeal, Alex's robust and precise style of advocacy leaves no stone unturned, whilst also leading to practical and pragmatic results. Alex shines in matters requiring a deep analytical assessment of the prevailing issues and laws, and has the rare ability to boil down the most complex of issues into plain and easy-to-digest points, as well as provide his clients with viable, feasible and pragmatic options in the context of a litigation or dispute.</p>
                </section>
                <section id="notable-cases">
                    <h2>Notable Cases</h2>
                    <ul class="content-list">
                        <li>Representing the Claimant in an important and widely-reported Court of Appeal decision in <strong>Hare Wines Ltd v Kaur & Anor [2019] EWCA Civ 216</strong>. The judgment has significant implications for employers handling transfers of employees.</li>
                        <li>Representing the Appellant in a High Court reconsideration of a Head Teacher's fitness to practise following on from the Supreme Court decision in <strong>Reilly v Sandwell Metropolitan Borough Council [2018] UKSC 16</strong>.</li>
                        <li>Representing the Claimant in a successful pregnancy discrimination and unfair dismissal case against a solicitors' firm, which gained considerable media attention.</li>
                        <li>Advising a London-based tech company on High Court injunction proceedings and restraint of trade.</li>
                    </ul>
                </section>
                <section id="education">
                    <h2>Education</h2>
                    <ul class="content-list">
                        <li>PhD in Modern Languages (French and Italian) - University of Cambridge (Clare Hall)</li>
                        <li>MPhil in European Literature - University of Cambridge (Clare Hall)</li>
                        <li>Undergraduate Degree in English Language & Literature - University College London</li>
                        <li>Graduate Diploma in Law - University of Law (Bloomsbury)</li>
                        <li>BPTC - City Law School (incorporating the Inns of Court Law School)</li>
                    </ul>
                </section>
            </div>

            <div id="articles-view" class="page-view" style="display: none;">
                <section id="article-tupe-defence" class="article-page" style="display: none;">
                    <h2>News & Articles</h2>
                    <div class="article-item">
                        <h3>No "personal reasons" defence in TUPE automatically unfair dismissals</h3>
                        <p>This article addresses the implications of the Court of Appeal's decision in <em>Hare Wines Ltd v Kaur & Anor [2019] EWCA Civ 216</em>, a case in which I acted for the successful Claimant at first instance, in the EAT, and in the Court of Appeal. The judgment clarifies the application of the 'sole or principal reason' test under the Transfer of Undertakings (Protection of Employment) Regulations 2006 (TUPE).</p>
                    </div>
                </section>
                <section id="article-prosecutors-fallacy" class="article-page" style="display: none;">
                    <h2>News & Articles</h2>
                    <div class="article-item">
                        <h3>The Prosecutor’s Fallacy</h3>
                        <p>This is the classic illustration: a murder takes place. The forensics team identify hair from the crime scene. A DNA test is carried out, indicating that someone with a previous conviction who lives in the same town is a match...</p>
                    </div>
                </section>
                <section id="article-prospects-percentages" class="article-page" style="display: none;">
                    <h2>News & Articles</h2>
                    <div class="article-item">
                        <h3>What do percentage figures mean when stating a legal case’s prospects?</h3>
                        <p>More than once, having drafted legal advice and distilled my opinion on prospects of success into a percentage figure, the client has come back to me and questioned how I arrived at it...</p>
                    </div>
                </section>
                <section id="article-forced-distribution" class="article-page" style="display: none;">
                    <h2>News & Articles</h2>
                    <div class="article-item">
                        <h3>On Forced Distribution Performance Management</h3>
                        <p>In 2019 the UK’s civil service changed its mind about its use of forced distributions, deciding instead to move to more flexible, non-mandatory objective setting...</p>
                    </div>
                </section>
                <section id="article-employment-casino" class="article-page" style="display: none;">
                    <h2>News & Articles</h2>
                    <div class="article-item">
                        <h3>How to guess your award (without paying lawyers) — the employment law casino</h3>
                        <p>Imagine that, for whatever reason, you do not wish to engage a lawyer. Perhaps they are too expensive; perhaps lawyers do not have your trust...</p>
                    </div>
                </section>
            </div>

            <div id="limitation-view" class="page-view" style="display: none;">
                <section class="calculator-section">
                    <h2>Employment Tribunal Limitation Calculator</h2>
                    <div class="calculator-disclaimer">
                        <p><strong>Disclaimer:</strong> This tool is for informational purposes only and provides an estimate based on the statutory rules for extending time for ACAS Early Conciliation. It is not legal advice. You should always seek independent legal advice on your specific circumstances.</p>
                    </div>
                    <div class="calculator-inputs" id="limitation-calculator-inputs">
                        <h3>1. Primary Event</h3>
                        <div class="calculator-grid">
                            <div>
                                <label for="event_date">Effective Date of Termination or Last Act</label>
                                <input type="date" id="event_date">
                            </div>
                        </div>
                        <h3>2. Respondents & ACAS Early Conciliation</h3>
                        <div id="respondents-container"></div>
                        <button id="add-respondent-btn" type="button">Add Respondent</button>
                    </div>
                    <button id="calculate-btn" class="calc-button">Calculate Deadlines</button>
                    <div id="error-message" class="error-message"></div>
                    <div id="limitation-calculator-results" style="display: none;">
                        <div id="result-summary-container"></div>
                        <table class="results-table">
                            <thead><tr><th>Respondent</th><th>Final Deadline</th><th>Method</th><th>Provision</th></tr></thead>
                            <tbody id="results-table-body"></tbody>
                        </table>
                    </div>
                </section>
            </div>
            
            <div id="holiday-pay-view" class="page-view" style="display: none;">
                <section class="calculator-section">
                    <h2>Statutory Holiday Pay Calculator</h2>
                    <p>For part-year or irregular-hours workers, holiday pay should be calculated using a 52-week reference period. This tool estimates entitlement based on that method.</p>
                    <div class="calculator-disclaimer">
                        <p><strong>Disclaimer:</strong> This tool provides an estimate for informational purposes and is not legal advice. You should seek independent legal advice on your specific circumstances.</p>
                    </div>
                    <div class="calculator-inputs">
                        <div class="calculator-grid">
                            <div>
                                <label for="hp-total-pay">Total Gross Pay in 52-Week Period</label>
                                <input type="number" id="hp-total-pay" placeholder="e.g., 22000">
                            </div>
                            <div>
                                <label for="hp-weeks-worked">Number of Weeks Paid in Period</label>
                                <input type="number" id="hp-weeks-worked" placeholder="e.g., 45">
                            </div>
                        </div>
                    </div>
                    <button id="calculate-hp-btn" class="calc-button">Calculate Holiday Pay</button>
                    <div id="hp-results" class="pay-calculator-results" style="display: none;"></div>
                </section>
            </div>
            
            <div id="redundancy-pay-view" class="page-view" style="display: none;">
                <section class="calculator-section">
                    <h2>Statutory Redundancy Pay Calculator</h2>
                    <p>This tool calculates the minimum redundancy payment you are entitled to by law. Your employer may offer a more generous contractual scheme.</p>
                     <div class="calculator-disclaimer">
                        <p><strong>Disclaimer:</strong> This tool provides an estimate of statutory redundancy pay and is not legal advice. It uses the current statutory cap for weekly pay (£700 as of July 2024). You should seek independent legal advice on your specific circumstances.</p>
                    </div>
                    <div class="calculator-inputs">
                        <div class="calculator-grid">
                            <div><label for="rp-dob">Date of Birth</label><input type="date" id="rp-dob"></div>
                            <div><label for="rp-start-date">Employment Start Date</label><input type="date" id="rp-start-date"></div>
                            <div><label for="rp-end-date">Redundancy Date</label><input type="date" id="rp-end-date"></div>
                            <div><label for="rp-weekly-pay">Gross Weekly Pay (£)</label><input type="number" id="rp-weekly-pay" placeholder="e.g., 550"></div>
                        </div>
                    </div>
                    <button id="calculate-rp-btn" class="calc-button">Calculate Redundancy Pay</button>
                    <div id="rp-results" class="pay-calculator-results" style="display: none;"></div>
                </section>
            </div>

            <div id="disciplinary-view" class="page-view" style="display: none;">
                 <section class="calculator-section">
                    <h2>Disciplinary Process Health Check</h2>
                    <p>Audit your disciplinary procedure against the key principles of the ACAS Code of Practice to identify and mitigate legal risk.</p>
                     <div class="calculator-disclaimer">
                        <p><strong>Disclaimer:</strong> This tool provides an educational guide based on the ACAS Code of Practice. It is not a substitute for legal advice. An Employment Tribunal can adjust any awards by up to 25% for unreasonable failure to comply with the Code.</p>
                    </div>

                    <form id="disciplinary-checklist-form">
                        <div class="checklist-section">
                            <h5>Stage 1: The Investigation</h5>
                            <div class="checklist-question" id="q_investigation_conducted">
                                <p>1. Was an investigation conducted to establish the facts before deciding to proceed with a disciplinary hearing?</p>
                                <label><input type="radio" name="investigation_conducted" value="yes" required> Yes</label>
                                <label><input type="radio" name="investigation_conducted" value="no"> No</label>
                            </div>
                        </div>

                        <div class="checklist-section">
                            <h5>Stage 2: Notifying the Employee</h5>
                            <div class="checklist-question" id="q_notification_written">
                                <p>2. Was the employee informed of the allegations against them in writing?</p>
                                <label><input type="radio" name="notification_written" value="yes" required> Yes</label>
                                <label><input type="radio" name="notification_written" value="no"> No</label>
                            </div>
                            <div class="checklist-question" id="q_evidence_provided">
                                <p>3. Was the employee provided with copies of evidence with the notification letter?</p>
                                <label><input type="radio" name="evidence_provided" value="yes" required> Yes</label>
                                <label><input type="radio" name="evidence_provided" value="no"> No</label>
                            </div>
                            <div class="checklist-question" id="q_right_to_be_accompanied">
                                <p>4. Was the employee informed in writing of their statutory right to be accompanied?</p>
                                <label><input type="radio" name="right_to_be_accompanied" value="yes" required> Yes</label>
                                <label><input type="radio" name="right_to_be_accompanied" value="no"> No</label>
                            </div>
                        </div>

                        <div class="checklist-section">
                            <h5>Stage 3: The Disciplinary Hearing</h5>
                             <div class="checklist-question" id="q_hearing_impartial">
                                <p>5. Was the hearing conducted by a manager not previously involved in the investigation, where possible?</p>
                                <label><input type="radio" name="hearing_impartial" value="yes" required> Yes</label>
                                <label><input type="radio" name="hearing_impartial" value="no"> No</label>
                            </div>
                            <div class="checklist-question" id="q_hearing_case_stated">
                                <p>6. Was the employee given a full opportunity to present their case and respond to the evidence?</p>
                                <label><input type="radio" name="hearing_case_stated" value="yes" required> Yes</label>
                                <label><input type="radio" name="hearing_case_stated" value="no"> No</label>
                            </div>
                            <div class="checklist-question" id="q_decision_deferred">
                                <p>7. Was the decision on an outcome deferred until after the hearing had concluded?</p>
                                <label><input type="radio" name="decision_deferred" value="yes" required> Yes</label>
                                <label><input type="radio" name="decision_deferred" value="no"> No</label>
                            </div>
                        </div>

                        <div class="checklist-section">
                            <h5>Stage 4: The Decision & Appeal</h5>
                            <div class="checklist-question" id="q_decision_in_writing">
                                <p>8. Was the final decision communicated to the employee in writing?</p>
                                <label><input type="radio" name="decision_in_writing" value="yes" required> Yes</label>
                                <label><input type="radio" name="decision_in_writing" value="no"> No</label>
                            </div>
                            <div class="checklist-question" id="q_appeal_right_offered">
                                <p>9. Was the employee explicitly notified of their right to appeal?</p>
                                <label><input type="radio" name="appeal_right_offered" value="yes" required> Yes</label>
                                <label><input type="radio" name="appeal_right_offered" value="no"> No</label>
                            </div>
                             <div class="checklist-question" id="q_appeal_impartial">
                                <p>10. If an appeal was held, was it heard impartially by a manager not previously involved (and ideally more senior)?</p>
                                <label><input type="radio" name="appeal_impartial" value="yes" required> Yes</label>
                                <label><input type="radio" name="appeal_impartial" value="no"> No</label>
                                <label><input type="radio" name="appeal_impartial" value="na"> N/A</label>
                            </div>
                        </div>

                        <button type="button" id="generate-report-btn" class="calc-button">Generate Risk Report</button>
                    </form>

                    <div id="checklist-report" class="checklist-report" style="display: none;"></div>
                </section>
            </div>
        </main>
    </div>

    <script>
        // --- Core Site Navigation Logic ---
        function showPage(pageId) {
            document.querySelectorAll('.page-view').forEach(view => view.style.display = 'none');
            document.querySelectorAll('.sidebar-nav a, .articles-nav a').forEach(link => link.classList.remove('nav-active'));
            const viewToShow = document.getElementById(pageId);
            let activeLink;
            if (pageId.startsWith('article-')) {
                document.getElementById('articles-view').style.display = 'block';
                if(viewToShow) viewToShow.style.display = 'block';
                activeLink = document.querySelector(`.articles-nav a[onclick*="${pageId}"]`);
            } else {
                if(viewToShow) viewToShow.style.display = 'block';
                activeLink = document.querySelector(`.sidebar-nav a[onclick*="${pageId}"]`);
            }
            if (activeLink) activeLink.classList.add('nav-active');
        }

        document.addEventListener('DOMContentLoaded', () => {
            initLimitationCalculator();
            initPayCalculators();
            initDisciplinaryChecklist();
            showPage('profile-view');
        });
        
        // --- Pay Calculators Logic ---
        function initPayCalculators() {
            const calculateHpBtn = document.getElementById('calculate-hp-btn');
            if(calculateHpBtn) calculateHpBtn.addEventListener('click', calculateHolidayPay);

            const calculateRpBtn = document.getElementById('calculate-rp-btn');
            if(calculateRpBtn) calculateRpBtn.addEventListener('click', calculateRedundancyPay);
        }

        function calculateHolidayPay() {
            const totalPay = parseFloat(document.getElementById('hp-total-pay').value);
            const weeksWorked = parseFloat(document.getElementById('hp-weeks-worked').value);
            const resultsDiv = document.getElementById('hp-results');
            resultsDiv.style.display = 'block';
            
            if (isNaN(totalPay) || isNaN(weeksWorked) || totalPay <= 0 || weeksWorked <= 0) {
                resultsDiv.innerHTML = `<div class="error-message">Please enter valid, positive numbers for pay and weeks paid.</div>`;
                return;
            }

            const averageWeeklyPay = totalPay / weeksWorked;
            const statutoryEntitlementWeeks = 5.6;
            const totalHolidayPay = averageWeeklyPay * statutoryEntitlementWeeks;

            resultsDiv.innerHTML = `
                <div class="pay-result-box">
                    <div class="result-breakdown">Your estimated annual statutory holiday pay is:</div>
                    <div class="result-headline">£${totalHolidayPay.toFixed(2)}</div>
                    <hr>
                    <div class="result-breakdown">
                        <strong>Calculation Breakdown:</strong><br>
                        - Average Weekly Pay: £${totalPay.toFixed(2)} / ${weeksWorked} weeks = <strong>£${averageWeeklyPay.toFixed(2)}</strong><br>
                        - Statutory Entitlement: <strong>${statutoryEntitlementWeeks}</strong> weeks<br>
                        - Total Estimated Pay: £${averageWeeklyPay.toFixed(2)} &times; ${statutoryEntitlementWeeks} = <strong>£${totalHolidayPay.toFixed(2)}</strong>
                    </div>
                </div>`;
        }

        function calculateRedundancyPay() {
            const dob = new Date(document.getElementById('rp-dob').value);
            const startDate = new Date(document.getElementById('rp-start-date').value);
            const endDate = new Date(document.getElementById('rp-end-date').value);
            const weeklyPay = parseFloat(document.getElementById('rp-weekly-pay').value);
            const resultsDiv = document.getElementById('rp-results');
            resultsDiv.style.display = 'block';

            if (isNaN(dob.getTime()) || isNaN(startDate.getTime()) || isNaN(endDate.getTime()) || isNaN(weeklyPay)) {
                resultsDiv.innerHTML = `<div class="error-message">Please fill in all date and pay fields correctly.</div>`;
                return;
            }
            if (startDate > endDate) {
                 resultsDiv.innerHTML = `<div class="error-message">Employment Start Date cannot be after the Redundancy Date.</div>`;
                return;
            }

            const serviceYears = Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24 * 365.25));

            if (serviceYears < 2) {
                resultsDiv.innerHTML = `<div class="pay-result-box"><div class="result-breakdown" style="text-align:center;">Statutory redundancy pay requires a minimum of 2 years of continuous service.</div></div>`;
                return;
            }

            const cappedServiceYears = Math.min(serviceYears, 20);
            const weeklyPayCap = 700; // For 2024-2025. This needs annual review.
            const cappedWeeklyPay = Math.min(weeklyPay, weeklyPayCap);
            let totalWeeksPayable = 0;
            let breakdown = '';

            for (let i = 0; i < cappedServiceYears; i++) {
                const ageAtAnniversary = Math.floor((endDate - dob) / (1000 * 60 * 60 * 24 * 365.25)) - i;
                let multiplier = 0.5;
                if (ageAtAnniversary >= 41) multiplier = 1.5;
                else if (ageAtAnniversary >= 22) multiplier = 1.0;
                totalWeeksPayable += multiplier;
                breakdown += `<li>Year ${serviceYears - i} (age ${ageAtAnniversary}): <strong>${multiplier.toFixed(1)}</strong> week's pay</li>`;
            }
            
            const totalRedundancyPay = totalWeeksPayable * cappedWeeklyPay;

            resultsDiv.innerHTML = `
                <div class="pay-result-box">
                    <div class="result-breakdown">Your estimated statutory redundancy payment is:</div>
                    <div class="result-headline">£${totalRedundancyPay.toFixed(2)}</div>
                    <hr>
                    <div class="result-breakdown">
                        <strong>Calculation Breakdown:</strong><br>
                        - Full Years of Service: <strong>${serviceYears}</strong> (capped at <strong>${cappedServiceYears}</strong> for calculation)<br>
                        - Your Gross Weekly Pay: <strong>£${weeklyPay.toFixed(2)}</strong> (capped at <strong>£${cappedWeeklyPay.toFixed(2)}</strong> for calculation)<br>
                        - Total Weeks' Pay Entitlement: <strong>${totalWeeksPayable.toFixed(1)}</strong><br>
                        - Total: ${totalWeeksPayable.toFixed(1)} weeks &times; £${cappedWeeklyPay.toFixed(2)} = <strong>£${totalRedundancyPay.toFixed(2)}</strong>
                    </div>
                     <div class="result-breakdown" style="margin-top: 1rem;">
                        <strong>Entitlement per year of service (most recent first):</strong><br>
                        <ul>${breakdown}</ul>
                    </div>
                </div>`;
        }

        // --- Disciplinary Checklist Logic ---
        function initDisciplinaryChecklist() {
            const generateBtn = document.getElementById('generate-report-btn');
            if (generateBtn) generateBtn.addEventListener('click', generateDisciplinaryReport);
        }

        function generateDisciplinaryReport() {
            const form = document.getElementById('disciplinary-checklist-form');
            const reportContainer = document.getElementById('checklist-report');
            
            if (!form.checkValidity()) {
                let firstInvalid = form.querySelector(':invalid');
                alert("Please answer all applicable questions before generating the report.");
                firstInvalid.closest('.checklist-question').scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }

            const answers = {
                investigation_conducted: form.elements.investigation_conducted.value,
                notification_written: form.elements.notification_written.value,
                evidence_provided: form.elements.evidence_provided.value,
                right_to_be_accompanied: form.elements.right_to_be_accompanied.value,
                hearing_impartial: form.elements.hearing_impartial.value,
                hearing_case_stated: form.elements.hearing_case_stated.value,
                decision_deferred: form.elements.decision_deferred.value,
                decision_in_writing: form.elements.decision_in_writing.value,
                appeal_right_offered: form.elements.appeal_right_offered.value,
                appeal_impartial: form.elements.appeal_impartial.value,
            };

            const risks = [];
            const goodPractices = [];

            const checks = [
                { key: 'investigation_conducted', good: 'Conducted a preliminary investigation.', risk: 'Failure to investigate before proceeding.', quote: 'ACAS Code, para 5: "It is important to carry out necessary investigations... to establish the facts of the case."' },
                { key: 'notification_written', good: 'Employee notified of allegations in writing.', risk: 'Failure to notify the employee in writing.', quote: 'ACAS Code, para 9: "The employee should be notified of this in writing..."' },
                { key: 'evidence_provided', good: 'Evidence provided to employee before hearing.', risk: 'Failure to provide evidence to the employee.', quote: 'ACAS Code, para 11: "...the employee should be given a copy of any written evidence, which may include any witness statements."' },
                { key: 'right_to_be_accompanied', good: 'Employee informed of right to be accompanied.', risk: 'Failure to inform employee of the statutory right to be accompanied.', quote: 'ACAS Code, para 15: "Workers have a statutory right to be accompanied... at any... disciplinary hearing."' },
                { key: 'hearing_impartial', good: 'Hearing conducted by an impartial manager.', risk: 'Potential bias in hearing.', quote: 'ACAS Code principles of fairness require the hearing manager to be impartial.' },
                { key: 'hearing_case_stated', good: 'Employee was given the opportunity to state their case.', risk: 'Employee not given a full opportunity to state their case.', quote: 'ACAS Code, para 13: "Allow the employee to set out their case and answer any allegations..."' },
                { key: 'decision_deferred', good: 'Decision was deferred until after the hearing.', risk: 'Decision made during the hearing, suggesting pre-determination.', quote: 'ACAS Code, para 17: "Following the hearing the employer should decide whether or not disciplinary... action is justified."' },
                { key: 'decision_in_writing', good: 'Decision was communicated in writing.', risk: 'Failure to provide the decision in writing.', quote: 'ACAS Code, para 18: "The employee should be informed of the decision... in writing."' },
                { key: 'appeal_right_offered', good: 'Right of appeal was offered.', risk: 'Failure to offer a right of appeal.', quote: 'ACAS Code, para 25: "Employees should be told they can appeal against any disciplinary action."' },
                { key: 'appeal_impartial', good: 'Appeal was heard by an impartial manager.', risk: 'Potential bias in the appeal hearing.', quote: 'ACAS Code, para 26: "The appeal should be dealt with impartially and wherever possible by a manager who has not previously been involved in the case."' }
            ];

            checks.forEach(check => {
                if (answers[check.key] === 'yes') {
                    goodPractices.push(check.good);
                } else if (answers[check.key] === 'no') {
                    risks.push({ title: check.risk, quote: check.quote });
                }
            });

            let reportHTML = '<h3>Disciplinary Process Risk Report</h3>';
            
            if (risks.length > 0) {
                reportHTML += `<div class="report-section report-red"><h4>Potential Risk Areas Identified (${risks.length})</h4>`;
                risks.forEach(risk => {
                    reportHTML += `<div class="red-flag"><div class="red-flag-title">Risk: ${risk.title}</div><blockquote>${risk.quote}</blockquote><div class="red-flag-implication">A Tribunal will take this into account and may find a dismissal unfair or increase an award by up to 25%.</div></div>`;
                });
                reportHTML += `</div>`;
            } else {
                 reportHTML += `<div class="report-section report-green"><h4>No Major Risk Areas Identified</h4><div class="green-flag">Based on your answers, the procedure appears to align well with the core principles of the ACAS Code.</div></div>`;
            }

            if (goodPractices.length > 0) {
                 reportHTML += `<div class="report-section report-green"><h4>Areas of Good Practice (${goodPractices.length})</h4>`;
                 goodPractices.forEach(practice => { reportHTML += `<div class="green-flag">✓ ${practice}</div>`; });
                 reportHTML += `</div>`;
            }
            
            reportHTML += `<div class="calculator-disclaimer"><p><strong>Next Steps:</strong> This report highlights potential deviations from the ACAS Code of Practice. For specialist advice on managing the risks identified or for representation in defending a claim, please get in touch to arrange a consultation.</p></div><button onclick="showPage('profile-view')" class="calc-button">Contact Alex MacMillan</button>`;

            reportContainer.innerHTML = reportHTML;
            reportContainer.style.display = 'block';
            reportContainer.scrollIntoView({ behavior: 'smooth' });
        }
        
        // --- Limitation Calculator Logic ---
        function initLimitationCalculator() {
            // Assume this function exists and is populated as before
        }

    </script>
</body>
</html>
