<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alex MacMillan | Employment Law Barrister</title>
    <meta name="description" content="The professional website for Alex MacMillan, a UK-based employment law barrister, featuring articles and legal calculators.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        /* --- Original Styles --- */
        :root {
            --bg-color: #ffffff;
            --sidebar-bg: #f5f5f5;
            --text-color: #333333;
            --heading-color: #111111;
            --accent-color: #003366; /* A professional navy blue */
            --border-color: #e0e0e0;
            --link-hover-bg: #e9e9e9;
        }
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        .site-wrapper { display: flex; min-height: 100vh; }
        .sidebar { width: 280px; background-color: var(--sidebar-bg); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; position: fixed; height: 100%; overflow-y: auto; }
        .sidebar-content { padding: 1.5rem; }
        .main-content { margin-left: 280px; padding: 2rem 3rem; width: calc(100% - 280px); }
        header { text-align: center; margin-bottom: 2rem; }
        .profile-photo { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 3px solid var(--border-color); margin-bottom: 1rem; }
        h1, h2, h3, h4 { font-family: 'DM Serif Display', serif; color: var(--heading-color); margin-top: 0; }
        h1 { font-size: 1.8rem; margin-bottom: 0.25rem; }
        .subtitle { font-size: 1rem; color: var(--accent-color); margin-top: 0; font-weight: 600; }
        .call-date { font-size: 0.9rem; color: #666; margin-top: 0.5rem; }
        .sidebar-nav { margin-bottom: 1.5rem; }
        .sidebar-nav h4 { margin-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }
        .sidebar-nav a, .articles-nav a { display: block; padding: 0.6rem 1rem; text-decoration: none; color: var(--text-color); border-radius: 4px; margin-bottom: 0.25rem; transition: background-color 0.2s; }
        .sidebar-nav a:hover, .articles-nav a:hover { background-color: var(--link-hover-bg); }
        .sidebar-nav a.nav-active, .articles-nav a.nav-active { background-color: var(--accent-color); color: white; font-weight: 600; }
        .articles-nav ul { list-style-type: none; padding: 0; margin: 0; }
        .contact-box { background-color: #e9e9e9; padding: 1rem; border-radius: 4px; font-size: 0.9rem; }
        .contact-box h3 { margin-top: 0; }
        .contact-box a { color: var(--accent-color); }
        footer { font-size: 0.8rem; color: #777; text-align: center; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color); }
        section { margin-bottom: 2.5rem; }
        .content-list { list-style: none; padding-left: 0; }
        .content-list li { padding-left: 1.5rem; text-indent: -1.5rem; margin-bottom: 1rem; }
        .content-list li::before { content: '■'; color: var(--accent-color); padding-right: 0.75rem; }
        .testimonial-item { border-left: 3px solid var(--accent-color); padding-left: 1.5rem; margin-bottom: 1.5rem; }
        .testimonial-item p { margin-top: 0; font-style: italic; }
        .testimonial-item cite { font-style: normal; font-weight: 600; color: #555; }
        .article-item h3 { margin-bottom: 0.5rem; }
        .article-item hr { margin: 2rem 0; }

        /* --- Calculator & Calendar Styles --- */
        .calculator-section { max-width: 900px; }
        .calculator-disclaimer { background-color: #fffbe6; border: 1px solid #ffe58f; padding: 1rem; border-radius: 4px; margin-bottom: 2rem; }
        .calculator-disclaimer p { margin: 0; }
        .calculator-grid, .respondent-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; align-items: end; margin-bottom: 1rem; }
        .calculator-inputs label, .calculator-inputs h3 { display: block; font-weight: 600; margin-bottom: 0.5rem; }
        .calculator-inputs h3 { margin-top: 2rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }
        .calculator-inputs input[type="date"], .calculator-inputs input[type="text"], .calculator-inputs input[type="number"], .calculator-inputs select { width: 100%; padding: 0.6rem; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-family: 'Inter', sans-serif; font-size: 1rem; }
        .respondent-row .remove-btn-wrapper { padding-bottom: 0.6rem; }
        .calc-button, #add-respondent-btn, #calculate-btn, .remove-btn { font-family: 'Inter', sans-serif; font-weight: 600; padding: 0.75rem 1.5rem; border-radius: 4px; border: none; cursor: pointer; transition: background-color 0.2s; }
        #add-respondent-btn { background-color: #e0e0e0; color: #333; }
        .calc-button, #calculate-btn { background-color: var(--accent-color); color: white; display: block; width: 100%; margin-top: 2rem; font-size: 1.1rem; }
        .remove-btn { background-color: #f44336; color: white; padding: 0.6rem; width: 100%; }
        #add-respondent-btn:hover { background-color: #d0d0d0; }
        .calc-button:hover, #calculate-btn:hover { background-color: #002244; }
        .remove-btn:hover { background-color: #d32f2f; }
        .calculator-results, .pay-calculator-results { margin-top: 2rem; }
        .error-message { color: #d32f2f; font-weight: bold; margin-bottom: 1rem; }
        .result-summary { font-size: 1.2rem; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; }
        .result-summary-earliest { background-color: #e6f4ea; border: 1px solid #b2d8b5; color: #2d6a4f; }
        .result-summary-passed { background-color: #ffebee; border: 1px solid #ffcdd2; color: #c62828; }
        .pay-result-box { background-color: #e6f4ea; border: 1px solid #b2d8b5; padding: 1.5rem; border-radius: 4px; }
        .pay-result-box .result-headline { font-family: 'DM Serif Display', serif; font-size: 2.5rem; color: #2d6a4f; margin: 0 0 1rem 0; text-align: center; }
        .pay-result-box .result-breakdown { font-size: 0.9rem; line-height: 1.5; color: #333; }
        .pay-result-box .result-breakdown strong { color: #111; }
        .pay-result-box hr { border: 0; border-top: 1px solid #b2d8b5; margin: 1rem 0; }
        .results-table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; font-size: 0.9rem; }
        .results-table th, .results-table td { border: 1px solid var(--border-color); padding: 0.8rem; text-align: left; }
        .results-table th { background-color: var(--sidebar-bg); }
        .results-table .highlight-row { background-color: #e6f4ea; }
        #calendar-legend { margin: 1.5rem 0 1rem 0; }
        #calendar-legend span { margin-right: 1rem; font-size: 0.9rem; }
        #calendar-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1.5rem; margin-top: 1rem; }
        .month { border: 1px solid #ccc; }
        .month h4 { margin: 0; background: var(--sidebar-bg); padding: .5rem; text-align: center; color: var(--heading-color); font-family: 'Inter', sans-serif; font-weight: 600;}
        .cal { width: 100%; border-collapse: collapse; }
        .cal th, .cal td { width: 14.285%; height: 40px; text-align: center; border: 1px solid #e0e0e0; }
        .cal th { font-weight: 600; font-size: .85rem; background: #f0f0f0; }
        .cal-day.ec { background: #a5d8ff; } /* Light blue for EC */
        .cal-day.event { background: #ffdead; font-weight: bold; } /* Navajo white for event */
        .cal-day.deadline { background: #f7786b; color: #fff; font-weight: 700; } /* Light red for deadline */
        .cal-day.today { outline: 2px solid #00a8e8; outline-offset: -2px; } /* Cyan outline for today */
    </style>

</head>
<body>

    <div class="site-wrapper">
        <aside class="sidebar">
            <div class="sidebar-content">
                <header>
                    <img src="professional_headshot.jpg" alt="Professional headshot of Alexander MacMillan, Barrister" class="profile-photo" onerror="this.onerror=null;this.src='https://placehold.co/150x150/EFEFEF/333333?text=A.M.';">
                    <h1>Alex MacMillan</h1>
                    <p class="subtitle">Employment Law Barrister</p>
                    <p class="call-date">Called to the Bar: 2015</p>
                </header>

                <nav class="sidebar-nav">
                    <h4>Main</h4>
                    <a href="javascript:void(0);" onclick="showPage('profile-view');" class="nav-active">Main Profile</a>
                    <a href="https://www.st-philips.com/our_people/alexander-macmillan/" target="_blank" rel="noopener noreferrer">Official Chambers Profile</a>
                    <a href="https://www.linkedin.com/in/dralexandermacmillan/" target="_blank" rel="noopener noreferrer">LinkedIn Profile</a>
                </nav>

                <nav class="sidebar-nav">
                    <h4>Calculators</h4>
                    <a href="javascript:void(0);" onclick="showPage('limitation-view');">Limitation Date Calculator</a>
                    <a href="javascript:void(0);" onclick="showPage('holiday-pay-view');">Holiday Pay Calculator</a>
                    <a href="javascript:void(0);" onclick="showPage('redundancy-pay-view');">Redundancy Pay Calculator</a>
                </nav>

                <nav class="sidebar-nav articles-nav">
                    <h4>Articles</h4>
                    <ul>
                        <li><a href="javascript:void(0);" onclick="showPage('article-tupe-defence');">No "personal reasons" defence...</a></li>
                        <li><a href="javascript:void(0);" onclick="showPage('article-prosecutors-fallacy');">The Prosecutor’s Fallacy</a></li>
                        <li><a href="javascript:void(0);" onclick="showPage('article-prospects-percentages');">On Percentage Prospects</a></li>
                        <li><a href="javascript:void(0);" onclick="showPage('article-forced-distribution');">On Forced Distributions</a></li>
                        <li><a href="javascript:void(0);" onclick="showPage('article-employment-casino');">The Employment Law Casino</a></li>
                    </ul>
                </nav>

                <div class="contact-box">
                    <h3>Contact</h3>
                    <p class="chambers-details">
                        <strong>St Philips Barristers</strong><br>
                        Email: <a href="mailto:employment&pi@st-philips.com">employment&pi@st-philips.com</a><br>
                        Telephone: +44 (0) 121 246 7015
                    </p>
                </div>
                
                <footer>
                    <p>&copy; 2025 Alex MacMillan</p>
                </footer>
            </div>
        </aside>

        <main class="main-content">
            <div id="profile-view" class="page-view">
                </div>

            <div id="articles-view" class="page-view" style="display: none;">
                </div>

            <div id="limitation-view" class="page-view" style="display: none;">
                <section class="calculator-section">
                    <h2>Employment Tribunal Limitation Calculator</h2>
                    <div class="calculator-disclaimer">
                        <p><strong>Disclaimer:</strong> This tool is for informational purposes only and provides an estimate based on the statutory rules for extending time for ACAS Early Conciliation. It is not legal advice. The calculation of limitation dates can be complex and subject to specific exceptions. You should always seek independent legal advice on your specific circumstances. No liability is accepted for any reliance placed on this tool.</p>
                    </div>
                    <div class="calculator-inputs" id="limitation-calculator-inputs">
                         </div>
                    <div class="calculator-results" id="limitation-calculator-results" style="display: none;">
                        </div>
                </section>
            </div>
            
            <div id="holiday-pay-view" class="page-view" style="display: none;">
                <section class="calculator-section">
                    <h2>Statutory Holiday Pay Calculator</h2>
                    <p>For part-year or irregular-hours workers, holiday pay should be calculated using a 52-week reference period. This tool estimates entitlement based on that method.</p>
                    <div class="calculator-disclaimer">
                        <p><strong>Disclaimer:</strong> This tool provides an estimate for informational purposes and is not legal advice. It applies to workers with irregular hours or part-year workers (like term-time workers). The calculation of 'a week's pay' can be complex. You should seek independent legal advice on your specific circumstances.</p>
                    </div>
                    <div class="calculator-inputs">
                        <div class="calculator-grid">
                            <div>
                                <label for="hp-total-pay">Total Gross Pay in Reference Period</label>
                                <input type="number" id="hp-total-pay" placeholder="e.g., 15000">
                            </div>
                            <div>
                                <label for="hp-weeks-worked">Number of Weeks Worked in Period</label>
                                <input type="number" id="hp-weeks-worked" placeholder="e.g., 42">
                            </div>
                        </div>
                    </div>
                    <button id="calculate-hp-btn" class="calc-button">Calculate Holiday Pay</button>
                    <div id="hp-results" class="pay-calculator-results" style="display: none;"></div>
                </section>
            </div>
            
            <div id="redundancy-pay-view" class="page-view" style="display: none;">
                <section class="calculator-section">
                    <h2>Statutory Redundancy Pay Calculator</h2>
                    <p>This tool calculates the minimum redundancy payment you are entitled to by law. Your employer may offer a more generous contractual scheme.</p>
                     <div class="calculator-disclaimer">
                        <p><strong>Disclaimer:</strong> This tool provides an estimate of statutory redundancy pay and is not legal advice. It uses the current statutory cap for weekly pay. The calculation assumes continuous employment. You should seek independent legal advice on your specific circumstances and any contractual entitlements.</p>
                    </div>
                    <div class="calculator-inputs">
                        <div class="calculator-grid">
                            <div>
                                <label for="rp-dob">Date of Birth</label>
                                <input type="date" id="rp-dob">
                            </div>
                            <div>
                                <label for="rp-start-date">Employment Start Date</label>
                                <input type="date" id="rp-start-date">
                            </div>
                             <div>
                                <label for="rp-end-date">Redundancy Date</label>
                                <input type="date" id="rp-end-date">
                            </div>
                            <div>
                                <label for="rp-weekly-pay">Gross Weekly Pay (£)</label>
                                <input type="number" id="rp-weekly-pay" placeholder="e.g., 550">
                            </div>
                        </div>
                    </div>
                    <button id="calculate-rp-btn" class="calc-button">Calculate Redundancy Pay</button>
                    <div id="rp-results" class="pay-calculator-results" style="display: none;"></div>
                </section>
            </div>

        </main>
    </div>

    <script>
        // --- Core Site Navigation Logic ---
        function showPage(pageId) {
            document.querySelectorAll('.page-view').forEach(view => view.style.display = 'none');
            document.querySelectorAll('.sidebar-nav a, .articles-nav a').forEach(link => link.classList.remove('nav-active'));
            
            const viewToShow = document.getElementById(pageId);
            let activeLink;

            if (pageId.startsWith('article-')) {
                document.getElementById('articles-view').style.display = 'block';
                if(viewToShow) viewToShow.style.display = 'block';
                activeLink = document.querySelector(`.articles-nav a[onclick*="${pageId}"]`);
            } else {
                if(viewToShow) viewToShow.style.display = 'block';
                activeLink = document.querySelector(`.sidebar-nav a[onclick*="${pageId}"]`);
            }
            
            if (activeLink) {
                activeLink.classList.add('nav-active');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Restore content of profile view, articles, and limitation calculator if needed
            // For brevity, their content is omitted here but should be in the final file.
            // initLimitationCalculator(); // Assuming this function exists for the limitation tool
            initPayCalculators();
            showPage('profile-view');
        });

        // --- Pay Calculators Logic ---
        function initPayCalculators() {
            // Holiday Pay Calculator
            const calculateHpBtn = document.getElementById('calculate-hp-btn');
            if(calculateHpBtn) {
                calculateHpBtn.addEventListener('click', calculateHolidayPay);
            }

            // Redundancy Pay Calculator
            const calculateRpBtn = document.getElementById('calculate-rp-btn');
            if(calculateRpBtn) {
                calculateRpBtn.addEventListener('click', calculateRedundancyPay);
            }
        }

        function calculateHolidayPay() {
            const totalPay = parseFloat(document.getElementById('hp-total-pay').value);
            const weeksWorked = parseFloat(document.getElementById('hp-weeks-worked').value);
            const resultsDiv = document.getElementById('hp-results');
            
            if (isNaN(totalPay) || isNaN(weeksWorked) || totalPay <= 0 || weeksWorked <= 0) {
                resultsDiv.innerHTML = `<div class="error-message">Please enter valid, positive numbers for pay and weeks worked.</div>`;
                resultsDiv.style.display = 'block';
                return;
            }

            const averageWeeklyPay = totalPay / weeksWorked;
            const statutoryEntitlementWeeks = 5.6;
            const totalHolidayPay = averageWeeklyPay * statutoryEntitlementWeeks;

            resultsDiv.innerHTML = `
                <div class="pay-result-box">
                    <div class="result-breakdown">Your estimated annual statutory holiday pay is:</div>
                    <div class="result-headline">£${totalHolidayPay.toFixed(2)}</div>
                    <hr>
                    <div class="result-breakdown">
                        <strong>Calculation Breakdown:</strong><br>
                        - Average Weekly Pay: £${totalPay.toFixed(2)} / ${weeksWorked} weeks = <strong>£${averageWeeklyPay.toFixed(2)}</strong><br>
                        - Statutory Entitlement: <strong>${statutoryEntitlementWeeks}</strong> weeks<br>
                        - Total Estimated Pay: £${averageWeeklyPay.toFixed(2)} &times; ${statutoryEntitlementWeeks} = <strong>£${totalHolidayPay.toFixed(2)}</strong>
                    </div>
                </div>
            `;
            resultsDiv.style.display = 'block';
        }

        function calculateRedundancyPay() {
            const dob = new Date(document.getElementById('rp-dob').value);
            const startDate = new Date(document.getElementById('rp-start-date').value);
            const endDate = new Date(document.getElementById('rp-end-date').value);
            const weeklyPay = parseFloat(document.getElementById('rp-weekly-pay').value);
            const resultsDiv = document.getElementById('rp-results');

            if (isNaN(dob) || isNaN(startDate) || isNaN(endDate) || isNaN(weeklyPay)) {
                resultsDiv.innerHTML = `<div class="error-message">Please fill in all date and pay fields correctly.</div>`;
                resultsDiv.style.display = 'block';
                return;
            }

            const serviceYears = Math.floor((endDate - startDate) / (365.25 * 24 * 60 * 60 * 1000));

            if (serviceYears < 2) {
                resultsDiv.innerHTML = `<div class="pay-result-box"><div class="result-breakdown">Statutory redundancy pay requires a minimum of 2 years of continuous service.</div></div>`;
                resultsDiv.style.display = 'block';
                return;
            }

            const cappedServiceYears = Math.min(serviceYears, 20);
            const weeklyPayCap = 700; // As of April 2024, check for annual updates.
            const cappedWeeklyPay = Math.min(weeklyPay, weeklyPayCap);

            let totalWeeksPayable = 0;
            let breakdown = '';

            for (let i = 0; i < cappedServiceYears; i++) {
                const anniversaryDate = new Date(endDate);
                anniversaryDate.setFullYear(endDate.getFullYear() - i);
                const ageAtAnniversary = Math.floor((anniversaryDate - dob) / (365.25 * 24 * 60 * 60 * 1000));

                let multiplier = 0;
                if (ageAtAnniversary >= 41) {
                    multiplier = 1.5;
                } else if (ageAtAnniversary >= 22) {
                    multiplier = 1.0;
                } else {
                    multiplier = 0.5;
                }
                totalWeeksPayable += multiplier;
                breakdown += `<li>Year ${serviceYears - i} (age ${ageAtAnniversary}): <strong>${multiplier}</strong> week's pay</li>`;
            }
            
            const totalRedundancyPay = totalWeeksPayable * cappedWeeklyPay;

            resultsDiv.innerHTML = `
                <div class="pay-result-box">
                    <div class="result-breakdown">Your estimated statutory redundancy payment is:</div>
                    <div class="result-headline">£${totalRedundancyPay.toFixed(2)}</div>
                    <hr>
                    <div class="result-breakdown">
                        <strong>Calculation Breakdown:</strong><br>
                        - Full Years of Service: <strong>${serviceYears}</strong> (capped at <strong>${cappedServiceYears}</strong> for calculation)<br>
                        - Your Gross Weekly Pay: <strong>£${weeklyPay.toFixed(2)}</strong> (capped at <strong>£${cappedWeeklyPay.toFixed(2)}</strong> for calculation)<br>
                        - Total Weeks' Pay Entitlement: <strong>${totalWeeksPayable.toFixed(1)}</strong><br>
                        - Calculation: ${totalWeeksPayable.toFixed(1)} weeks &times; £${cappedWeeklyPay.toFixed(2)} = <strong>£${totalRedundancyPay.toFixed(2)}</strong>
                    </div>
                     <div class="result-breakdown" style="margin-top: 1rem;">
                        <strong>Entitlement per year of service:</strong><br>
                        <ul>${breakdown}</ul>
                    </div>
                </div>
            `;
            resultsDiv.style.display = 'block';
        }
    </script>
</body>
</html>
